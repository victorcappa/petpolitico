using UnityEngine;
using UnityEngine.UI;

/* 

SISTEMA POPULARIDADE

- é um dos status do jogo
- se inicia em 50%
- tem uma velocidade de perda de 0.1
- quando FichaLimpa está acima de 80 (método AlmaHonesta), tem uma velocidade de ganho de 0.5
- O método CPI aumenta a velocidade de perda 
- o método AlmaHonesta aumenta a velocidade de ganho
- ambos os métodos estão na classe FichaLimpa

*/

public class Popularidade : MonoBehaviour
{

    public Text pop_txtUI;
    public float veloPerdaPop = 0.1f;
    public float veloGanhaPop = 0.5f;
    public float popularidade = 50;
    public float max_pop = 100;
    public float min_pop = 0;
    public Slider barraPop;

  

    void Start()
    {

        PopPersonagens();
  

    }

    void Update()
    {

        PopPersonagens();

        MaxMinPop();
    }

    void MaxMinPop()
    {
        if (popularidade <= min_pop)
        {
            popularidade = min_pop;
        }

        if (popularidade >= max_pop)
        {
            popularidade = max_pop;
        }
    }


    public void PopPersonagens()

    {
        PlayerPrefs.SetFloat("PopularidadeNaScene", popularidade);

        if (PlayerPrefs.GetInt("LulaDentroScene") == 1)

        {
            popularidade = PlayerPrefs.GetFloat("PopularidadeLula");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeLula"));

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //
            if (tempPopularidade <= 0)

            {
                tempPopularidade = 1;
            }
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");


            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");

            popularidade = PlayerPrefs.GetFloat("PopularidadeLula");

            // ganho ou perda de pop

            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeLula") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeLula") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }
            //------------------------------------------------

            // min pop

            PlayerPrefs.SetFloat("PopularidadeLula", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeLula") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeLula", 0);

            }

            // max pop
            PlayerPrefs.SetFloat("PopularidadeLula", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeLula") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeLula", 100);
            }


            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA

            if (PlayerPrefs.GetInt("LevelLula") <= 1 && PlayerPrefs.GetFloat("PopularidadeLula") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeLula", 50);

            }

        }
      
        
        if (PlayerPrefs.GetInt("CiroDentroScene") == 1)
        {
            popularidade = PlayerPrefs.GetFloat("PopularidadeCiro");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeCiro"));
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");

            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");

            popularidade = PlayerPrefs.GetFloat("PopularidadeCiro");

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //

            //------------------------------------------------

            // ganho ou perda de pop


            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeCiro") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeCiro") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            //------------------------------------------------

            // min pop

            PlayerPrefs.SetFloat("PopularidadeCiro", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeCiro") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeCiro", 0);
            }

            // max pop

            PlayerPrefs.SetFloat("PopularidadeCiro", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeCiro") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeCiro", 100);
            }



            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA

            if (PlayerPrefs.GetInt("LevelCiro") <= 1 && PlayerPrefs.GetFloat("PopularidadeCiro") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeCiro", 50);
            }


        }

      
        if (PlayerPrefs.GetInt("BolsoDentroScene") == 1)
        {
            
            popularidade = PlayerPrefs.GetFloat("PopularidadeBolso");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeBolso"));
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");

            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");


            popularidade = PlayerPrefs.GetFloat("PopularidadeBolso");
            popularidade -= Time.deltaTime * veloPerdaPop;

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //

            // ganho ou perda de pop

            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeBolso") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeBolso") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            //------------------------------------------------

            // MIN POP

            PlayerPrefs.SetFloat("PopularidadeBolso", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeBolso") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeBolso", 0);
            }

            // MAX POP 

            PlayerPrefs.SetFloat("PopularidadeBolso", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeBolso") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeBolso", 100);
            }

            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA


            if (PlayerPrefs.GetInt("LevelBolso") <= 1 && PlayerPrefs.GetFloat("PopularidadeBolso") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeBolso", 50);
            }

        }

        if (PlayerPrefs.GetInt("DilmaDentroScene") == 1)
        {
            popularidade = PlayerPrefs.GetFloat("PopularidadeDilma");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeDilma"));
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");

            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");

            popularidade = PlayerPrefs.GetFloat("PopularidadeDilma");

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //

            //------------------------------------------------

            // ganho ou perda de pop


            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeDilma") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeDilma") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            //------------------------------------------------

            // min pop

            PlayerPrefs.SetFloat("PopularidadeDilma", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeDilma") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeDilma", 0);
            }

            // max pop

            PlayerPrefs.SetFloat("PopularidadeDilma", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeDilma") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeDilma", 100);
            }



            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA

            if (PlayerPrefs.GetInt("LevelDilma") <= 1 && PlayerPrefs.GetFloat("PopularidadeDilma") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeDilma", 50);
            }


        }

        if (PlayerPrefs.GetInt("SuplicyDentroScene") == 1)
        {
            popularidade = PlayerPrefs.GetFloat("PopularidadeSuplicy");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeSuplicy"));
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");

            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");

            popularidade = PlayerPrefs.GetFloat("PopularidadeSuplicy");

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //

            //------------------------------------------------

            // ganho ou perda de pop


            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeSuplicy") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeSuplicy") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            //------------------------------------------------

            // min pop

            PlayerPrefs.SetFloat("PopularidadeSuplicy", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeSuplicy") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeSuplicy", 0);
            }

            // max pop

            PlayerPrefs.SetFloat("PopularidadeSuplicy", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeSuplicy") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeSuplicy", 100);
            }



            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA

            if (PlayerPrefs.GetInt("LevelSuplicy") <= 1 && PlayerPrefs.GetFloat("PopularidadeSuplicy") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeSuplicy", 50);
            }


        }

        if (PlayerPrefs.GetInt("EneasDentroScene") == 1)
        {
            popularidade = PlayerPrefs.GetFloat("PopularidadeEneas");
            float tempPopularidade = Mathf.Round(PlayerPrefs.GetFloat("PopularidadeEneas"));
            pop_txtUI.text = (tempPopularidade.ToString()); // + "%");

            veloPerdaPop = PlayerPrefs.GetFloat("VeloPerdaPop");
            veloGanhaPop = PlayerPrefs.GetFloat("VeloGanhaPop");

            popularidade = PlayerPrefs.GetFloat("PopularidadeEneas");

            // BARRA POP

            barraPop.maxValue = max_pop;
            barraPop.value = popularidade;

            //

            //------------------------------------------------

            // ganho ou perda de pop


            if (PlayerPrefs.GetInt("AlmaHonesta") == 0)

            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeEneas") <= 51)
            {
                popularidade += Time.deltaTime * veloGanhaPop;

            }

            if (PlayerPrefs.GetInt("AlmaHonesta") == 1 && PlayerPrefs.GetFloat("PopularidadeEneas") > 51)
            {
                popularidade -= Time.deltaTime * veloPerdaPop;

            }

            //------------------------------------------------

            // min pop

            PlayerPrefs.SetFloat("PopularidadeEneas", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeEneas") <= 0)
            {
                PlayerPrefs.SetFloat("PopularidadeEneas", 0);
            }

            // max pop

            PlayerPrefs.SetFloat("PopularidadeEneas", popularidade);

            if (PlayerPrefs.GetFloat("PopularidadeEneas") >= 100)
            {
                PlayerPrefs.SetFloat("PopularidadeEneas", 100);
            }



            // VERIFICAR SE É A PRIMEIRA VEZ QUE JOGA

            if (PlayerPrefs.GetInt("LevelEneas") <= 1 && PlayerPrefs.GetFloat("PopularidadeEneas") <= 1)
            {
                PlayerPrefs.SetFloat("PopularidadeEneas", 50);
            }


        }

    }

    public void deletePlayerPrefs()
    {
        PlayerPrefs.DeleteAll();

    }

 
}
